# NeuroHorizon æ‰§è¡Œè®¡åˆ’

> **æœ¬æ–‡æ¡£æ˜¯é¡¹ç›®çš„å¯æ‰§è¡Œè®¡åˆ’ä¸»ä½“ï¼Œèšç„¦ä»»åŠ¡åˆ—è¡¨ä¸å®ŒæˆçŠ¶æ€ã€‚**
>
> - é¡¹ç›®èƒŒæ™¯ä¸æ¶æ„åˆ†æï¼š`cc_core_files/proposal_review.md`ï¼ˆ**æ‰§è¡Œå‰è¯·å…ˆé˜…è¯»å¯¹åº” Phase çš„å†…å®¹**ï¼‰
> - æ•°æ®é›†è¯¦ç»†è§„åˆ’ï¼š`cc_core_files/dataset.md`
> - å®Œæ•´ç ”ç©¶ææ¡ˆï¼š`cc_core_files/proposal.md`
> - ä»»åŠ¡æ‰§è¡Œè®°å½•ï¼š`cc_todo/{phase-folder}/{date}-{phase}-{task}.md`
>
> **å…³é”®æ–‡ä»¶æ¸…å•ã€é£é™©ä¸åº”å¯¹ã€æ¶æ„è®¾è®¡ç»†èŠ‚å‡åœ¨ `cc_core_files/proposal_review.md` ä¸­ã€‚**

---

## æ€»è§ˆ

**æ€»é¢„è®¡å‘¨æœŸ**ï¼š16-20 å‘¨ï¼ˆçº¦ 4-5 ä¸ªæœˆï¼‰

```
Phase 0: ç¯å¢ƒå‡†å¤‡ä¸åŸºçº¿å¤ç°           â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  [Week 1-2]
Phase 1: è‡ªå›å½’æ”¹é€ éªŒè¯ + é•¿æ—¶ç¨‹ç”Ÿæˆ   â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  [Week 3-8]
Phase 2: è·¨ Session æµ‹è¯•              â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  [Week 7-12]
Phase 3: Data Scaling + ä¸‹æ¸¸ä»»åŠ¡      â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  [Week 10-14]
Phase 4: å¤šæ¨¡æ€å¼•å…¥                   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  [Week 13-17]
Phase 5: å®Œæ•´å®éªŒã€æ¶ˆèä¸è®ºæ–‡          â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆ  [Week 16-20]
```

**æœ€å°å¯è¡Œå‘è¡¨è·¯å¾„ï¼ˆMVPï¼‰**ï¼š
Phase 0-1ï¼ˆç¯å¢ƒ + è‡ªå›å½’æ”¹é€ ï¼‰â†’ Phase 2ï¼ˆè·¨ session æ³›åŒ–ï¼‰â†’ Phase 1 é•¿æ—¶ç¨‹å®éªŒ â†’ Phase 5 æ¶ˆè
> MVP ä»…éœ€ Brainsets æ•°æ® + æ ¸å¿ƒæ¨¡å‹ + è·¨ session æ³›åŒ–å®éªŒ + é•¿æ—¶é—´é¢„æµ‹å®éªŒ + å…³é”®æ¶ˆèå³å¯æ„æˆå¯å‘è¡¨çš„å·¥ä½œã€‚Allen å¤šæ¨¡æ€å®éªŒä½œä¸ºè¡¥å……è´¡çŒ®ã€‚

---

## Phase 0ï¼šç¯å¢ƒå‡†å¤‡ä¸åŸºçº¿å¤ç°

> **ç›®æ ‡**ï¼šéªŒè¯å¼€å‘ç¯å¢ƒå®Œæ•´æ€§ï¼Œæ·±åº¦ç†è§£ POYO ä»£ç æ¶æ„ï¼Œåœ¨ Brainsets æ•°æ®ä¸Šå»ºç«‹è¡Œä¸ºè§£ç  baselineã€‚
> **æ•°æ®é›†**ï¼šBrainsets åŸç”Ÿï¼ˆPerich-Miller 2018 ä¸ºä¸»ï¼‰
> **æ‰§è¡Œå‚è€ƒ**ï¼š`cc_core_files/proposal_review.md` ç¬¬ä¸‰èŠ‚
> **cc_todo**ï¼š`cc_todo/phase0-env-baseline/`

### 0.1 ç¯å¢ƒéªŒè¯ä¸ä»£ç ç†è§£

- [x] **0.1.1** ç¡®è®¤å¹¶éªŒè¯ POYO conda ç¯å¢ƒå¯ç”¨æ€§
  - ğŸ“„ `cc_todo/phase0-env-baseline/20260228-phase0-env-code-understanding.md`
  - æœåŠ¡å™¨ä¸Šå·²æœ‰ POYO ç›¸å…³ conda ç¯å¢ƒï¼Œå…ˆ `conda env list` æŸ¥çœ‹ç°æœ‰ç¯å¢ƒï¼Œå°è¯•ç›´æ¥æ¿€æ´»ä½¿ç”¨
  - éªŒè¯æ ¸å¿ƒä¾èµ–å®Œæ•´æ€§ï¼šPyTorch, wandb, hydra, brainsetsï¼›ç¼ºå¤±é¡¹æŒ‰éœ€è¡¥è£…è€Œéé‡å»ºç¯å¢ƒ
  - æ¢³ç†ä»£ç æ¨¡å—ä¾èµ–å…³ç³»å›¾ï¼šspike tokenization â†’ unit embedding â†’ Perceiver encoder â†’ readout â†’ è®­ç»ƒå¾ªç¯

- [x] **0.1.2** ç²¾è¯» SPINTï¼ˆIDEncoder æœºåˆ¶ï¼‰å’Œ Neuroformerï¼ˆè‡ªå›å½’ç”Ÿæˆ + å¤šæ¨¡æ€ï¼‰ä¸¤ç¯‡å…³é”®è®ºæ–‡
  - ğŸ“„ `cc_todo/phase0-env-baseline/20260228-phase0-env-code-understanding.md`

- [x] **0.1.3** åŸºäº0.1.1å’Œ0.1.2çš„æ‰§è¡Œç»“æœç»™äºˆå¯¹äºåç»­é˜¶æ®µè¦ä¿®æ”¹ä»£ç çš„å»ºè®®
  - ğŸ“„ `cc_todo/phase0-env-baseline/20260228-phase0-env-code-understanding.md`

### 0.2 æ•°æ®å‡†å¤‡ä¸æ¢ç´¢

- [x] **0.2.1** æ£€æŸ¥ `NeuroHorizon/data/` ä¸­å·²æœ‰çš„ Brainsets æ•°æ®
  - ğŸ“„ `cc_todo/phase0-env-baseline/20260228-phase0-data-explore.md`
  - åˆ—å‡º `data/raw/` å’Œ `data/processed/` ä¸‹çš„å†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦å·²ä¸‹è½½ Perich-Miller æˆ–å…¶ä»– Brainsets æ•°æ®é›†
  - è‹¥å·²æœ‰æ•°æ®ï¼šç¡®è®¤æ ¼å¼æ˜¯å¦ç¬¦åˆ brainsets pipeline è¦æ±‚ï¼Œå¯ç›´æ¥å¤ç”¨
  - è‹¥æ— æˆ–ä¸å®Œæ•´ï¼šé€šè¿‡ brainsets API è¡¥å……ä¸‹è½½ `perich_miller_population_2018`ï¼ˆå…ˆ 5-10 sessionsï¼‰
  - è®°å½•æ•°æ®å­˜æ”¾ä½ç½®åˆ° `cc_core_files/data.md`

- [x] **0.2.2** æ•°æ®åŠ è½½éªŒè¯
  - ğŸ“„ `cc_todo/phase0-env-baseline/20260228-phase0-data-explore.md`
  - é€šè¿‡ POYO æ•°æ® pipeline çš„ sanity checkï¼Œç¡®è®¤æ•°æ®å¯æ­£å¸¸æµå…¥è®­ç»ƒæ¡†æ¶

- [x] **0.2.3** æ•°æ®æ·±åº¦æ¢ç´¢ä¸å¯è§†åŒ–åˆ†æ
  - ğŸ“„ `cc_todo/phase0-env-baseline/20260228-phase0-data-explore.md`

  > ç›®æ ‡ï¼šå»ºç«‹å¯¹ Perich-Miller æ•°æ®é›†çš„å®Œæ•´æ•°æ®ç›´è§‰ï¼Œä¸ºåç»­è¾“å…¥/è¾“å‡ºçª—å£è®¾è®¡ã€è‡ªå›å½’å¯è¡Œæ€§è¯„ä¼°æä¾›ä¾æ®ã€‚
  >
  > **è„šæœ¬**ï¼šæ–°å»º `scripts/analysis/explore_brainsets.py`ï¼ˆè®°å½•åˆ° `cc_core_files/scripts.md`ï¼‰
  > **ç»“æœ**ï¼šå›¾è¡¨è¾“å‡ºè‡³ `results/figures/data_exploration/`ï¼ˆè®°å½•åˆ° `cc_core_files/results.md`ï¼‰

  - **æ•°æ®æ ¼å¼ä¸ç»“æ„**
    - brainsets æ•°æ®æ–‡ä»¶æ ¼å¼ï¼ˆHDF5 / .npy / å…¶ä»–ï¼‰ï¼Œå­—æ®µåˆ—è¡¨ï¼ŒåŠ è½½æ¥å£

  - **æ•°æ®é›†æ¦‚è§ˆç»Ÿè®¡**
    - æ€» sessions æ•°ï¼›å„åŠ¨ç‰©ï¼ˆC / J / Mï¼‰çš„ session æ•°åˆ†å¸ƒ
    - æ¯ä¸ª session çš„ trial æ•°é‡ã€æ€»è®°å½•æ—¶é•¿
    - æ¯ä¸ª session çš„ neuron æ•°é‡ï¼ˆæœ€å° / æœ€å¤§ / ä¸­ä½æ•°ï¼Œç”»åˆ†å¸ƒç›´æ–¹å›¾ï¼‰

  - **ä»»åŠ¡ç»“æ„åˆ†æ**
    - ä»»åŠ¡ç±»å‹ç¡®è®¤ï¼ˆCenter-out reaching / Random target reaching ç­‰ï¼‰
    - Trial é˜¶æ®µåˆ’åˆ†åŠå„é˜¶æ®µæ—¶é•¿åˆ†å¸ƒï¼ˆhold period / movement period / rest periodï¼‰ï¼›ç”»ç›´æ–¹å›¾
    - Trial æ€»æ—¶é•¿åˆ†å¸ƒï¼›inter-trial intervalï¼ˆITIï¼‰æ˜¯å¦å­˜åœ¨åŠå…¶æ—¶é•¿
    - ç¡®è®¤"è¾“å…¥çª—å£ = hold periodï¼Œé¢„æµ‹çª—å£ = reach period"çš„è‡ªç„¶åˆ’åˆ†æ˜¯å¦æˆç«‹
    - å„é˜¶æ®µæ—¶é•¿æ˜¯å¦æ»¡è¶³ 250ms / 500ms / 1s çš„çª—å£éœ€æ±‚ï¼ˆåˆ—è¡¨æ±‡æ€»ï¼‰

  - **å¯ç”¨æ¨¡æ€æ¢³ç†**
    - ç¥ç»æ•°æ®ï¼šspike times æ ¼å¼ã€æ—¶é—´åˆ†è¾¨ç‡
    - è¡Œä¸ºæ•°æ®ï¼šcursor velocity / positionã€hand position ç­‰å­—æ®µæ˜¯å¦å­˜åœ¨ï¼Œé‡‡æ ·ç‡
    - è¾…åŠ©ä¿¡æ¯ï¼štrial æ ‡ç­¾ã€ç›®æ ‡æ–¹å‘ã€æˆåŠŸ/å¤±è´¥æ ‡æ³¨ç­‰

  - **ç¥ç»å…ƒç»Ÿè®¡ç‰¹å¾**
    - å„ session å¹³å‡ firing rate åˆ†å¸ƒï¼ˆç›´æ–¹å›¾ï¼Œå¤š session å åŠ ï¼‰
    - PSTH ç¤ºä¾‹å›¾ï¼ˆå¯¹é½ trial onsetï¼Œå±•ç¤º 2-3 ä¸ªå…¸å‹ session çš„ç¾¤ä½“å¹³å‡æ´»åŠ¨ï¼Œåˆ† hold / reach é˜¶æ®µï¼‰
    - å•ç¥ç»å…ƒ raster plot ç¤ºä¾‹ï¼ˆ2-3 ä¸ªç¥ç»å…ƒï¼Œå±•ç¤º spike æ¨¡å¼çš„ä»£è¡¨æ€§ä¸å¤šæ ·æ€§ï¼‰
    - Spike count åœ¨ä¸åŒ bin å®½åº¦ï¼ˆ20ms / 50ms / 100msï¼‰ä¸‹çš„åˆ†å¸ƒï¼ˆå‡å€¼ã€æ–¹å·®ã€ç¨€ç–åº¦ï¼‰

  - **è‡ªå›å½’å¯è¡Œæ€§è¯„ä¼°**
    - spike ç¨€ç–æ€§è¯„ä¼°ï¼šæ¯ 20ms bin å†…å¹³å‡ spike countï¼Œåˆ¤æ–­ Poisson NLL æ˜¯å¦åˆé€‚
    - Session é—´ç¥ç»å…ƒé‡å åº¦ï¼ˆbrainsets æ˜¯å¦æœ‰è·¨ session çš„ neuron å¯¹åº”å…³ç³»ï¼‰
    - æ»‘åŠ¨çª—å£æ–¹æ¡ˆï¼ˆæ–¹æ¡ˆ Bï¼‰çš„å¯è¡Œæ€§ï¼štrial è¾¹ç•Œæ˜¯å¦ä¼šå¼•èµ·å¼‚å¸¸æ´»åŠ¨

  - **å°ç»“ä¸å†³ç­–å»ºè®®**ï¼ˆä»¥æ–‡å­—æ®µè½æ€»ç»“ï¼‰
    - æ¨è Phase 1 åˆæœŸå¼€å‘ä½¿ç”¨çš„æ•°æ®å­é›†ï¼ˆå“ªå‡ ä¸ª sessionï¼‰
    - æ¨èçš„ input window / prediction window é•¿åº¦
    - æ½œåœ¨é—®é¢˜è®°å½•ï¼ˆtrial è¿‡çŸ­ã€æŸäº› session ç¥ç»å…ƒæ•°é‡ä¸è¶³ç­‰ï¼‰

- [ ] **0.2.4** ï¼ˆå¯é€‰ï¼‰ä¸‹è½½ NLB MC_Maze æ•°æ®ï¼ˆbrainsets å†…ï¼‰ä½œä¸ºæ”¹é€ åçš„ sanity check åŸºå‡†

### 0.3 POYO åŸºçº¿å¤ç°

- [ ] **0.3.1** åœ¨ Perich-Miller æ•°æ®ä¸Šè¿è¡Œç°æœ‰ POYO+ è¡Œä¸ºè§£ç ï¼ŒéªŒè¯ RÂ² > 0.3ï¼ˆæˆ–æ¥è¿‘è®ºæ–‡æ•°å€¼ Â±20%ï¼‰
- [ ] **0.3.2** åˆ†æ POYO encoder è¾“å‡ºçš„ latent representation è´¨é‡ï¼ˆPCA / è§£ç æ¢é’ˆï¼‰
- [ ] **0.3.3** è®°å½•åŸºçº¿æ€§èƒ½æŠ¥å‘Šï¼Œä½œä¸ºåç»­æ”¹é€ å‰åçš„å¯¹æ¯”é”šç‚¹

---

## Phase 1ï¼šè‡ªå›å½’æ”¹é€ éªŒè¯ + é•¿æ—¶ç¨‹ç”ŸæˆéªŒè¯

> **ç›®æ ‡**ï¼šåœ¨ Brainsets åŸç”Ÿæ•°æ®ä¸Šå®ç°æ ¸å¿ƒè‡ªå›å½’è§£ç å™¨ï¼ŒéªŒè¯ causal mask æ­£ç¡®æ€§å’Œä¸åŒé¢„æµ‹çª—å£ä¸‹çš„ç”Ÿæˆè´¨é‡ã€‚
> **æ•°æ®é›†**ï¼šPerich-Miller 2018ï¼ˆBrainsets åŸç”Ÿï¼Œ5-20 sessionsï¼‰
> **æ‰§è¡Œå‚è€ƒ**ï¼š`cc_core_files/proposal_review.md` ç¬¬å››èŠ‚ï¼ˆå«å„æ¨¡å—ä»£ç çº§ä¿®æ”¹æ–¹æ¡ˆï¼‰
> **cc_todo**ï¼š`cc_todo/phase1-autoregressive/`

### 1.1 æ ¸å¿ƒæ¨¡å—å®ç°

- [ ] **1.1.1** æ·»åŠ  Poisson NLL Loss
  - ä¿®æ”¹ `torch_brain/nn/loss.py`ï¼Œå®ç° `PoissonNLLLoss`
  - å¤„ç†æ•°å€¼ç¨³å®šæ€§ï¼ˆlog-sum-exp æŠ€å·§ï¼Œé¿å… NaNï¼›æ³¨æ„ä½å‘æ”¾ç‡ç¥ç»å…ƒçš„ log(0) é—®é¢˜ï¼‰
  - å®ç° `forward(log_rate, spike_count, weights)` æ¥å£ï¼ˆä¸ç°æœ‰ loss æ¥å£ä¸€è‡´ï¼‰

- [ ] **1.1.2** æ³¨å†Œ spike_counts è¾“å‡ºæ¨¡æ€
  - ä¿®æ”¹ `torch_brain/registry.py`ï¼Œæ·»åŠ  `spike_counts` æ¨¡æ€ç±»å‹
  - å®šä¹‰ `timestamp_key`ã€`value_key`ã€`loss_fn`

- [ ] **1.1.3** ä¿®æ”¹ RotarySelfAttention æ”¯æŒ causal mask âš ï¸ é‡ç‚¹
  - ä¿®æ”¹ `torch_brain/nn/rotary_attention.py`
  - ä¿®æ”¹ `rotary_attn_pytorch_func` çš„ mask reshape é€»è¾‘ï¼ˆæ”¯æŒ 2D / 3D / 4D maskï¼‰
  - è‹¥ä½¿ç”¨ xformers åç«¯ï¼ŒåŒæ­¥ä¿®æ”¹ `rotary_attn_xformers_func`
  - æ–°å¢ `create_causal_mask(seq_len)` å·¥å…·å‡½æ•°
  - **å•å…ƒæµ‹è¯•**ï¼šéªŒè¯ causal mask æ­£ç¡®é˜»æ­¢æœªæ¥ token ä¿¡æ¯æ³„éœ²

- [ ] **1.1.4** å®ç°è‡ªå›å½’ Cross-Attention Decoder âš ï¸ é‡ç‚¹
  - æ–°å»º `torch_brain/nn/autoregressive_decoder.py`
  - å®ç° decoder blockï¼šcross-attn(bin_query â†’ encoder_latents) + causal self-attn(bins) + FFN
  - å®ç° Per-Neuron MLP Headï¼š`concat(bin_repr, unit_emb) â†’ log-rate`
  - å‚è€ƒ `proposal_review.md` ç¬¬å››èŠ‚å…³äºä¿¡æ¯ç“¶é¢ˆé—®é¢˜çš„è®¾è®¡æ–¹æ¡ˆé€‰æ‹©
  - **å•å…ƒæµ‹è¯•**ï¼šteacher forcing å’Œè‡ªå›å½’æ¨ç†ä¸¤ç§æ¨¡å¼å‡å¯è¿è¡Œ

- [ ] **1.1.5** ç»„è£… NeuroHorizon æ¨¡å‹ï¼ˆåˆ†ä¸‰æ­¥ï¼‰
  - **1.1.5a** æ¨¡å‹éª¨æ¶ï¼šå¤ç”¨ POYO encoder + processing layersï¼Œé›†æˆ IDEncoder é¢„ç•™æ¥å£ï¼ŒéªŒè¯ encoder éƒ¨åˆ†ç»´åº¦æ­£ç¡®
  - **1.1.5b** Decoder é›†æˆï¼šæ¥å…¥ AutoregressiveDecoderï¼Œå®ç°å®Œæ•´ forward()ï¼ŒéªŒè¯ teacher forcing æ¨¡å¼ç«¯åˆ°ç«¯å¯è¿è¡Œ
  - **1.1.5c** tokenize() å®ç°ï¼šæ„å»º spike count targetsï¼ˆbinning spike eventsï¼‰ï¼Œå¤„ç†å‚è€ƒçª—å£ï¼ŒéªŒè¯ä¸ collate å‡½æ•°çš„å…¼å®¹æ€§
  - æ›´æ–° `torch_brain/models/__init__.py` å¯¼å‡º

- [ ] **1.1.6** ç¼–å†™è®­ç»ƒè„šæœ¬ä¸è¯„ä¼°æŒ‡æ ‡
  - æ–°å»º `examples/neurohorizon/train.py` + Hydra configsï¼ˆSmall / Base ä¸¤å¥—é…ç½®ï¼‰
  - æ–°å»º `torch_brain/utils/neurohorizon_metrics.py`ï¼šPSTH ç›¸å…³æ€§ã€Poisson log-likelihoodã€RÂ²
  - å®ç°"é¢„æµ‹å‡†ç¡®æ€§éšæ—¶é—´æ­¥è¡°å‡"è¯„ä¼°æ›²çº¿

### 1.2 åŸºç¡€åŠŸèƒ½éªŒè¯

- [ ] **1.2.1** Teacher forcing æ¨¡å¼è®­ç»ƒï¼ˆ5-10 sessionsï¼ŒSmall é…ç½®ï¼‰
  - éªŒè¯ loss æ”¶æ•›ã€é¢„æµ‹ spike count åˆ†å¸ƒåˆç†ï¼ˆPoisson åˆ†å¸ƒç‰¹æ€§ï¼‰
  - ä¸ç®€å• baseline å¯¹æ¯”ï¼ˆPSTH-based predictionã€çº¿æ€§é¢„æµ‹ï¼‰

- [ ] **1.2.2** è‡ªå›å½’æ¨ç†éªŒè¯
  - éªŒè¯ causal mask åœ¨æ¨ç†æ—¶æ­£ç¡®ï¼ˆæœªæ¥ token ä¸è¢«çœ‹åˆ°ï¼‰
  - ç»˜åˆ¶è¯¯å·®éšé¢„æµ‹æ­¥æ•°çš„ä¼ æ’­æ›²çº¿ï¼Œè®°å½•è¡°å‡é€Ÿåº¦

### 1.3 é¢„æµ‹çª—å£æ¢¯åº¦æµ‹è¯•

- [ ] **1.3.1** 250ms é¢„æµ‹çª—å£å®éªŒï¼ˆ10-20 sessionsï¼‰
  - ä½œä¸ºåŸºçº¿ï¼Œè®°å½• PSTH ç›¸å…³æ€§ / RÂ²
  - æ–¹æ¡ˆ Aï¼ˆtrial å¯¹é½ï¼‰ï¼šè¾“å…¥ = hold periodï¼Œé¢„æµ‹ = reach period å‰ 250ms

- [ ] **1.3.2** 500ms é¢„æµ‹çª—å£å®éªŒ
  - è§† 250ms ç»“æœå†³å®šæ˜¯å¦å¼•å…¥ scheduled sampling
  - å¯¹æ¯”ï¼š500ms ä¸‹ trial å¯¹é½æ–¹æ¡ˆ A vs æ»‘åŠ¨çª—å£æ–¹æ¡ˆ B

- [ ] **1.3.3** 1000ms é¢„æµ‹çª—å£å®éªŒï¼ˆ~50 æ­¥è‡ªå›å½’ï¼‰
  - å®ç° scheduled samplingï¼ˆä» 100% teacher forcing çº¿æ€§è¡°å‡è‡³ ~10%ï¼Œ20-50 epochï¼‰
  - non-autoregressive parallel prediction å¯¹ç…§åŸºçº¿

- [ ] **1.3.4** é¢„æµ‹çª—å£æ±‡æ€»æŠ¥å‘Š
  - ç»˜åˆ¶æ€§èƒ½éšçª—å£é•¿åº¦çš„è¡°å‡æ›²çº¿ï¼ˆå†™å…¥ `cc_core_files/results.md`ï¼‰
  - å†³ç­–ï¼šPhase 2/3 å®éªŒçš„ä¸»è¦é¢„æµ‹çª—å£

---

## Phase 2ï¼šè·¨ Session æµ‹è¯•

> **ç›®æ ‡**ï¼šå®ç° IDEncoderï¼Œåœ¨ Brainsets æ•°æ®ä¸ŠéªŒè¯è·¨ session é›¶æ ·æœ¬æ³›åŒ–ï¼›å¯é€‰æ‰©å±•è‡³ IBL å¤§è§„æ¨¡æ•°æ®ã€‚
> **æ•°æ®é›†**ï¼šPerich-Miller 2018ï¼ˆå¿…åšï¼‰ï¼›IBLï¼ˆå¯é€‰æ‰©å±•ï¼Œè¯¦è§ `cc_core_files/dataset.md` ç¬¬ 3.3 èŠ‚ï¼‰
> **å‰æ**ï¼šPhase 1 çš„è‡ªå›å½’æ”¹é€ å·²éªŒè¯ causal mask æ­£ç¡®ã€loss æ”¶æ•›
> **æ‰§è¡Œå‚è€ƒ**ï¼š`cc_core_files/proposal_review.md` ç¬¬äº”èŠ‚
> **cc_todo**ï¼š`cc_todo/phase2-cross-session/`

### 2.1 IDEncoder å®ç°

- [ ] **2.1.1** å®ç°å‚è€ƒçª—å£ç‰¹å¾æå–
  - æ–°å»º `scripts/extract_reference_features.py`
  - è®¡ç®—æ¯ä¸ª neuron çš„ç»Ÿè®¡ç‰¹å¾ï¼ˆ~33dï¼‰ï¼šå¹³å‡å‘æ”¾ç‡(1d)ã€ISI å˜å¼‚ç³»æ•°(1d)ã€ISI log-histogram(20d)ã€è‡ªç›¸å…³ç‰¹å¾(10d)ã€Fano factor(1d)
  - æ³¨æ„ä½å‘æ”¾ç‡ç¥ç»å…ƒï¼ˆ<1 Hzï¼‰çš„ ISI ç›´æ–¹å›¾ç¨³å®šæ€§ï¼ˆè€ƒè™‘ç”¨ KDE ä»£æ›¿ç›´æ–¹å›¾ï¼‰

- [ ] **2.1.2** å®ç° IDEncoder MLP ç½‘ç»œ
  - æ–°å»º `torch_brain/nn/id_encoder.py`
  - ç½‘ç»œç»“æ„ï¼š3 å±‚ MLPï¼ˆLinear â†’ GELU â†’ LayerNormï¼‰ï¼Œè¾“å…¥ ~33dï¼Œè¾“å‡º d_model
  - æ³¨æ„ï¼šä½¿ç”¨æ ‡å‡† GELUï¼ˆé GEGLUï¼‰ï¼Œè¾“å…¥ç»´åº¦ä½ï¼Œé—¨æ§æœºåˆ¶ä¸å¿…è¦

- [ ] **2.1.3** é›†æˆåˆ° NeuroHorizon
  - æ›¿æ¢ `InfiniteVocabEmbedding`ï¼Œ**æ³¨æ„ä¿ç•™å…¶ tokenizer/detokenizer é€»è¾‘**ï¼ˆå‚è§ `proposal_review.md` ç¬¬äº”èŠ‚ï¼‰
  - æ›´æ–° `torch_brain/nn/__init__.py`ï¼›ä¼˜åŒ–å™¨å‚æ•°ç»„ï¼šIDEncoder ç”¨ AdamWï¼Œsession_emb ä¿ç•™ SparseLamb
  - éªŒè¯å‰å‘ä¼ æ’­ç»´åº¦åŒ¹é…ï¼Œend-to-end pipeline æ­£å¸¸è¿è¡Œ

### 2.2 IDEncoder åŸºç¡€éªŒè¯

- [ ] **2.2.1** åœ¨ Perich-Miller å•åŠ¨ç‰©å¤š session ä¸ŠéªŒè¯ç‰¹å¾æå–è´¨é‡
  - æ£€æŸ¥ç‰¹å¾åˆ†å¸ƒæ˜¯å¦åˆç†ï¼ˆä¸åŒ session çš„åŒåŠŸèƒ½ neuron ç‰¹å¾å¯èšç±»ï¼‰
  - å¯è§†åŒ– IDEncoder ç”Ÿæˆçš„ embedding ç©ºé—´ï¼ˆPCA / t-SNEï¼‰

- [ ] **2.2.2** End-to-end pipeline éªŒè¯ï¼ˆ5-10 sessionsï¼‰
  - æ›¿æ¢åçš„ NeuroHorizon æ­£å¸¸è®­ç»ƒã€loss æ”¶æ•›ï¼Œæ€§èƒ½ä¸ä½äº Phase 1 åŸºçº¿

### 2.3 Brainsets è·¨ Session æµ‹è¯•ï¼ˆå¿…åšï¼‰

- [ ] **2.3.1** Train/val/test åˆ’åˆ†ï¼ˆæŒ‰åŠ¨ç‰©ï¼‰
  - 2 åªçŒ´ï¼ˆCã€Jï¼‰ç”¨äºè®­ç»ƒï¼Œ1 åªçŒ´ï¼ˆMï¼‰held-out ä½œä¸º test
  - ä½¿ç”¨ 70+ sessions å…¨é‡è®­ç»ƒ

- [ ] **2.3.2** é›¶æ ·æœ¬æ³›åŒ–å®éªŒ
  - test session çš„ neuronï¼šä»…é€šè¿‡ IDEncoder å‰å‘ä¼ æ’­ç”Ÿæˆ embeddingï¼ˆä¸å¾®è°ƒï¼‰
  - è¯„ä¼°ï¼šRÂ² / PSTH ç›¸å…³æ€§

- [ ] **2.3.3** A/B å¯¹æ¯”å®éªŒ
  - IDEncoderï¼ˆgradient-freeï¼‰vs å›ºå®šåµŒå…¥ baselineï¼ˆPOYO åŸå§‹ï¼‰vs per-session å¾®è°ƒ upperbound
  - ç»“æœå†™å…¥ `cc_core_files/results.md`

- [ ] **2.3.4** ç»“æœæ±‡æ€»ä¸å†³ç­–
  - IDEncoder ç»“æœæ˜¯å¦è¶³å¤Ÿæ”¯æŒ paper è´¡çŒ®ï¼Ÿæ˜¯å¦éœ€è¦ IBL æ‰©å±•ï¼ˆè¯¦è§ 2.4ï¼‰ï¼Ÿ

### 2.4 IBL è·¨ Session æ‰©å±•ï¼ˆå¯é€‰ï¼‰

> **å‰æ**ï¼šPhase 2.3 ç»“æœä»¤äººæ»¡æ„ï¼Œéœ€æ›´å¤§è§„æ¨¡éªŒè¯è·¨ session æ³›åŒ–

- [ ] **2.4.1** å®‰è£… ONE API + ibllibï¼ŒéªŒè¯æ•°æ®ç®¡çº¿ï¼ˆä¸‹è½½ 10-20 sessions è°ƒè¯•ï¼Œ~5-10GBï¼‰

- [ ] **2.4.2** ç¼–å†™ IBL Dataset ç±»
  - æ–°å»º `examples/neurohorizon/datasets/ibl.py`
  - å®ç°æ»‘åŠ¨çª—å£ç­–ç•¥ï¼ˆä¸å¯¹é½ trialï¼‰ï¼›è´¨é‡è¿‡æ»¤ï¼šä»…ä½¿ç”¨ `clusters.label == 1`

- [ ] **2.4.3** IBL å¤§è§„æ¨¡è·¨ session å®éªŒ
  - é€æ­¥æ‰©å±•ï¼š20 â†’ 50 â†’ 100 sessionsï¼ˆè§†ç»“æœåŠ¨æ€è°ƒæ•´ï¼‰
  - æŒ‰å®éªŒå®¤åˆ’åˆ† train/testï¼ˆ12 ä¸ª labs è·¨å®éªŒå®¤æ³›åŒ–ï¼‰

### 2.5 FALCON Benchmarkï¼ˆå¯é€‰è¡¥å……ï¼‰

- [ ] **2.5.1** æ³¨å†Œå¹¶ä¸‹è½½ FALCON M1/M2 æ•°æ®
- [ ] **2.5.2** åœ¨ FALCON ä¸Šé‡åŒ–è·¨ session æ³›åŒ–æ”¹è¿›ï¼ˆä¸ IDEncoder baseline å¯¹æ¯”ï¼‰

---

## Phase 3ï¼šData Scaling + ä¸‹æ¸¸ä»»åŠ¡æ³›åŒ–

> **ç›®æ ‡**ï¼šæ­ç¤ºæ€§èƒ½éšè®­ç»ƒæ•°æ®é‡ï¼ˆsession æ•°ï¼‰çš„ scaling è§„å¾‹ï¼›éªŒè¯è‡ªå›å½’é¢„è®­ç»ƒå¯¹è¡Œä¸ºè§£ç ä¸‹æ¸¸ä»»åŠ¡çš„è¿ç§»å¢ç›Šã€‚
> **æ•°æ®é›†**ï¼šPerich-Miller 2018ï¼ˆå¿…åšï¼‰ï¼›IBLï¼ˆå¯é€‰æ‰©å±•ï¼Œéœ€ Phase 2.4 ç®¡çº¿å°±ç»ªï¼‰
> **å‰æ**ï¼šPhase 2 è·¨ session æ³›åŒ–å·²æœ‰åŸºæœ¬ç»“è®º
> **æ‰§è¡Œå‚è€ƒ**ï¼š`cc_core_files/proposal_review.md` ç¬¬å…­èŠ‚
> **cc_todo**ï¼š`cc_todo/phase3-scaling/`

### 3.1 Brainsets Scaling æµ‹è¯•ï¼ˆå¿…åšï¼‰

- [ ] **3.1.1** å‡†å¤‡ä¸åŒè§„æ¨¡çš„ Perich-Miller å­é›†ï¼ˆ5 / 10 / 20 / 40 / 70+ sessionsï¼‰
- [ ] **3.1.2** æ¯ä¸ªè§„æ¨¡ç‹¬ç«‹è®­ç»ƒï¼Œè®°å½•éªŒè¯é›† PSTH ç›¸å…³æ€§ / RÂ²
- [ ] **3.1.3** ç»˜åˆ¶ scaling æ›²çº¿ï¼Œåˆ†ææ˜¯å¦å­˜åœ¨ power-law å…³ç³»
- [ ] **3.1.4** å†³ç­–ï¼šæ›²çº¿æ˜¯å¦ä»åœ¨å¢é•¿ï¼Ÿæ˜¯å¦éœ€è¦ IBL å¤§è§„æ¨¡ Scalingï¼Ÿ

### 3.2 ä¸‹æ¸¸ä»»åŠ¡æ³›åŒ–ï¼ˆå¿…åšï¼‰

- [ ] **3.2.1** ç”¨è‡ªå›å½’é¢„è®­ç»ƒçš„ NeuroHorizon encoder åˆå§‹åŒ–ï¼ˆå†»ç»“ encoderï¼‰ï¼Œå¾®è°ƒè¡Œä¸ºè§£ç  head
- [ ] **3.2.2** ä¸ POYO ä»å¤´è®­ç»ƒçš„è¡Œä¸ºè§£ç å¯¹æ¯”ï¼ˆRÂ²ï¼‰ï¼Œè®°å½•è¿ç§»å¢ç›Š
- [ ] **3.2.3** éªŒè¯è‡ªå›å½’é¢„è®­ç»ƒæ˜¯å¦æ”¹å–„ä¸‹æ¸¸è§£ç è´¨é‡

### 3.3 IBL å¤§è§„æ¨¡ Scalingï¼ˆå¯é€‰ï¼‰

> **å‰æ**ï¼šIBL æ•°æ®ç®¡çº¿åœ¨ Phase 2.4 å·²å»ºç«‹

- [ ] **3.3.1** IBL 30 / 50 / 100 / 200 / 459 sessions scaling å®éªŒï¼ˆåŠ¨æ€æ‰©å¢ï¼Œè§† scaling æ›²çº¿å†³å®šï¼‰
- [ ] **3.3.2** è·¨å®éªŒå®¤é›¶æ ·æœ¬æ³›åŒ–ï¼ˆ12 labs train/test splitï¼‰
- [ ] **3.3.3** ç»˜åˆ¶å¤§è§„æ¨¡ scaling curveï¼ˆè®ºæ–‡æ ¸å¿ƒå›¾ä¹‹ä¸€ï¼‰ï¼Œå†™å…¥ `cc_core_files/results.md`

---

## Phase 4ï¼šå¤šæ¨¡æ€å¼•å…¥

> **ç›®æ ‡**ï¼šå®ç°å¹¶éªŒè¯è§†è§‰å›¾åƒï¼ˆDINOv2ï¼‰å’Œè¡Œä¸ºæ•°æ®çš„æ¡ä»¶æ³¨å…¥ï¼Œé‡åŒ–ä¸åŒæ¨¡æ€çš„é¢„æµ‹è´¡çŒ®ã€‚
> **æ•°æ®é›†**ï¼šAllen Visual Coding Neuropixelsï¼ˆ58 sessionsï¼‰ï¼Œè¯¦è§ `cc_core_files/dataset.md` ç¬¬ 3.5 èŠ‚
> **å‰æ**ï¼šPhase 2/3 çš„è‡ªå›å½’é¢„æµ‹å’Œè·¨ session æ³›åŒ–å·²æœ‰åŸºæœ¬ç»“è®º
> **æ‰§è¡Œå‚è€ƒ**ï¼š`cc_core_files/proposal_review.md` ç¬¬ä¸ƒèŠ‚
> **cc_todo**ï¼š`cc_todo/phase4-multimodal/`

### 4.1 Allen æ•°æ®å‡†å¤‡

- [ ] **4.1.1** ç¡®è®¤å­˜å‚¨ç©ºé—´ï¼ˆéœ€ > 150GBï¼‰ï¼Œè§„åˆ’æ•°æ®ä¸‹è½½è·¯å¾„
- [ ] **4.1.2** å®‰è£… AllenSDKï¼ˆç‹¬ç«‹ conda ç¯å¢ƒï¼Œé¿å…ä¾èµ–å†²çªï¼‰
- [ ] **4.1.3** ä¸‹è½½ Allen Visual Coding Neuropixels NWB æ•°æ®ï¼ˆ58 sessionsï¼‰ï¼›è®°å½•åˆ° `cc_core_files/data.md`
- [ ] **4.1.4** é¢„å¤„ç†è½¬ HDF5ï¼Œä¸»ç¯å¢ƒç›´æ¥åŠ è½½
- [ ] **4.1.5** ç¦»çº¿é¢„æå– DINOv2 embeddingsï¼ˆ**å¿…é¡»ç¦»çº¿é¢„è®¡ç®—ï¼Œä¸å¯è®­ç»ƒæ—¶å®æ—¶è®¡ç®—**ï¼‰
  - æ–°å»º `scripts/extract_dino_embeddings.py`
  - ç°åº¦å›¾ï¼ˆ918Ã—1174ï¼‰â†’ å¤åˆ¶ä¸‰é€šé“è½¬ RGB â†’ resize 224Ã—224 â†’ DINOv2 ViT-B â†’ ç¼“å­˜ä¸º `.pt`

### 4.2 å¤šæ¨¡æ€æ•°æ®é›†ä¸æ¨¡å‹å®ç°

- [ ] **4.2.1** ç¼–å†™ Allen Dataset ç±»ï¼ˆ`examples/neurohorizon/datasets/allen_multimodal.py`ï¼‰
- [ ] **4.2.2** å®ç°è¡Œä¸ºæ¡ä»¶æ³¨å…¥ï¼ˆlinear projection + cross-attnï¼Œæ³¨å…¥ä½ç½®å‚è§ `proposal_review.md`ï¼‰
- [ ] **4.2.3** å®ç° DINOv2 å›¾åƒæ¡ä»¶æ³¨å…¥ï¼ˆåŒæ¥å£ï¼ŒDINOv2 æƒé‡å†»ç»“ï¼Œä»…è®­ç»ƒæŠ•å½±å±‚ï¼‰

### 4.3 å¤šæ¨¡æ€å®éªŒ

- [ ] **4.3.1** Allen Natural Movies é•¿æ—¶ç¨‹è¿ç»­é¢„æµ‹ï¼ˆ250ms / 500ms / 1s æ¢¯åº¦æµ‹è¯•ï¼‰
- [ ] **4.3.2** å›¾åƒ-ç¥ç»å¯¹é½å®éªŒï¼ˆNatural Scenes + DINOv2ï¼Œé‡åŒ–è´¡çŒ®ï¼‰
- [ ] **4.3.3** å¤šæ¨¡æ€æ¶ˆèï¼ˆneural only / +behavior / +image / +behavior+imageï¼‰

---

## Phase 5ï¼šå®Œæ•´å®éªŒã€æ¶ˆèä¸è®ºæ–‡

> **cc_todo**ï¼š`cc_todo/phase5-experiments-paper/`

### 5.1 å®Œæ•´å®éªŒçŸ©é˜µ

- [ ] **5.1.1** é•¿æ—¶ç¨‹é¢„æµ‹å®éªŒï¼ˆ100ms / 200ms / 500ms / 1000ms é¢„æµ‹çª—å£ç³»ç»Ÿæ€§å¯¹æ¯”ï¼‰
- [ ] **5.1.2** è·¨ session æ³›åŒ–æ ¸å¿ƒå®éªŒï¼ˆå« baseline å…¨é¢å¯¹æ¯”ï¼‰
- [ ] **5.1.3** Data scaling law å®éªŒï¼ˆBrainsets + å¯é€‰ IBLï¼‰
- [ ] **5.1.4** å¤šæ¨¡æ€è´¡çŒ®åˆ†æï¼ˆå¯é€‰ï¼Œè‹¥ Phase 4 å®Œæˆï¼‰

### 5.2 æ¶ˆèå®éªŒ

- [ ] **5.2.1** IDEncoder æ¶ˆèï¼ˆA1: IDEncoder vs å¯å­¦ä¹ åµŒå…¥ï¼›A2: IDEncoder vs randomï¼‰
- [ ] **5.2.2** Decoder æ·±åº¦æ¶ˆèï¼ˆN_dec = 1 / 2 / 4ï¼‰
- [ ] **5.2.3** é¢„æµ‹çª—å£é•¿åº¦æ¶ˆèï¼ˆ100ms / 250ms / 500ms / 1000msï¼‰
- [ ] **5.2.4** Scheduled sampling æ¶ˆèï¼ˆæ—  / å›ºå®šæ¯”ä¾‹ / é€æ­¥è¡°å‡ï¼‰
- [ ] **5.2.5** Causal decoder vs parallel predictionï¼ˆéè‡ªå›å½’å¹¶è¡Œé¢„æµ‹ï¼‰å¯¹æ¯”

### 5.3 Baseline å¯¹æ¯”

- [ ] **5.3.1** PSTH-based baselineã€çº¿æ€§é¢„æµ‹ baseline
- [ ] **5.3.2** Neuroformerï¼ˆè‡ªå›å½’ç”Ÿæˆ + å¤šæ¨¡æ€ï¼Œæœ€æ¥è¿‘ NeuroHorizonï¼‰
- [ ] **5.3.3** NDT1/NDT2ï¼ˆmasked spike predictionï¼Œbinned countsï¼‰
- [ ] **5.3.4** NDT3ï¼ˆIBL ä¸Šæœ‰å…¬å¼€ç»“æœï¼ŒIBL å®éªŒæ—¶å¼•å…¥ï¼‰
- [ ] **5.3.5** NEDSï¼ˆåŒæ—¶æ”¯æŒ spike é¢„æµ‹ + è¡Œä¸ºè§£ç ï¼Œä¸åœºæ™¯æœ€æ¥è¿‘ï¼‰

### 5.4 ç»“æœå¯è§†åŒ–

- [ ] **5.4.1** Scaling curvesï¼ˆsession æ•° vs æ€§èƒ½æŠ˜çº¿å›¾ï¼‰
- [ ] **5.4.2** é¢„æµ‹æ€§èƒ½éšæ—¶é—´çª—å£è¡°å‡æ›²çº¿
- [ ] **5.4.3** æ¨¡æ€è´¡çŒ®å½’å› å›¾
- [ ] **5.4.4** IDEncoder embedding ç©ºé—´å¯è§†åŒ–ï¼ˆPCA / t-SNEï¼‰
- æ‰€æœ‰å›¾è¡¨è®°å½•åˆ° `cc_core_files/results.md`

### 5.5 è®ºæ–‡æ’°å†™

- [ ] **5.5.1** æ–¹æ³•ç« èŠ‚åˆç¨¿ï¼ˆArchitecture + IDEncoder + Autoregressive Decoderï¼‰
- [ ] **5.5.2** å®éªŒç« èŠ‚åˆç¨¿ï¼ˆå«æ‰€æœ‰æ ¸å¿ƒå›¾è¡¨ï¼‰
- [ ] **5.5.3** Introduction + Related Work + Discussion å®Œå–„
- [ ] **5.5.4** è®ºæ–‡å®šç¨¿ï¼Œå‡†å¤‡ç›®æ ‡ä¼šè®®ï¼ˆNeurIPS / ICLR / Nature Methodsï¼‰æŠ•ç¨¿

---

*è®¡åˆ’åˆ›å»ºï¼š2026-02-28ï¼›é™„å½•å†…å®¹å·²è¿ç§»è‡³ `cc_core_files/proposal_review.md`*
